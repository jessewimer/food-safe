{% extends "flowchart_result_base.html" %}

{% block title %}Product Detail{% endblock %}

{% block header_buttons %}
    {% if came_from == 'search' %}
        <a href="{% url 'search' %}?q={{ query|urlencode }}" class="back-button">← Back to Search</a>
    {% elif came_from == 'baby_food' %}
        <a href="{% url 'baby_food_list' %}" class="back-button">← Back</a>
    {% else %}
        <a href="javascript:history.back()" class="back-button">← Back</a>
    {% endif %}
    <a href="{% url 'landing' %}" class="home-button">Home</a>
{% endblock %}

{% block content %}
  <h2>{{ product.item_name }}</h2>

  <div class="product-info" style="max-width: 600px; width: 90%; padding: 1.5rem; margin-top: 1rem; background-color: #f8f8f8; border-radius: 16px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);">

    {% if shelf_lives %}
      {% for label, data in shelf_lives.items %}
        <div class="category-block" style="margin-bottom: 1.5rem;">
            <h3>{{ label }}</h3>

            {% if data.shelf_life_str %}
              <p><strong>Guidance:</strong> {{ data.shelf_life_str }}</p>
            {% endif %}

            {% if data.lower or data.upper %}
              <p><strong>Shelf Life:</strong>
                {% if data.same %}
                  {{ data.lower }} days
                {% else %}
                  {% if data.lower %}{{ data.lower }}{% endif %}
                  {% if data.lower and data.upper %}–{% endif %}
                  {% if data.upper %}{{ data.upper }}{% endif %} days
                {% endif %}
              </p>
            {% endif %}

            {% if data.cutoff %}
              <p><strong>Use if packaged after:</strong> {{ data.cutoff|date:"F j, Y" }}</p>
            {% endif %}

            {% if data.note %}
              <p><strong>Notes:</strong> {{ data.note }}</p>
            {% endif %}
        </div>
      {% endfor %}
    {% else %}
      <p><em>No shelf life information available for this product.</em></p>
    {% endif %}

  </div>
{% endblock %}
